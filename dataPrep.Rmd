---
title: "dataPrep"
author: "Bertram Hojer"
date: "4/27/2020"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r}
library(pacman)
p_load(tidyverse, lme4)

data <- read_csv("Ass4_data.csv", col_types = cols(ID = col_character()))

data$npause[data$npause == 0] <- NA
data$`speechrate (nsyll/dur)`[data$`speechrate (nsyll/dur)` == 0.0] <- NA

scale0_1 <- function(x, ...){(x - min(x, ...)) / (max(x, ...) - min(x, ...))}

hist(data$Pitch_IQR)

d <- data %>% 
  subset(Language == "dk") %>% 
  mutate(pitchVariability = scale0_1(log(Pitch_IQR)),
         pitchMAD = scale0_1(log(Pitch_MAD)),
         pauseFreq = scale0_1(log(Duration / npause), na.rm = T),
         speechRate = scale0_1(log(`speechrate (nsyll/dur)`), na.rm = T)) %>%
  select(ID, Diagnosis, pitchVariability, pitchMAD, pauseFreq, speechRate)

hist(d$pitchVariability, breaks = 15)
hist(d$pitchMAD, breaks = 15)
hist(d$pauseFreq, breaks = 15)
hist(d$speechRate, breaks = 15)

d[is.na(d)] <- 0

d_grouped_50 <- d %>% 
  group_by(ID) %>%
  summarise(Diagnosis = Diagnosis[1],
            pitchVariability = mean(pitchVariability),
            pitchMAD = mean(pitchMAD),
            pauseFreq = mean(pauseFreq),
            speechRate = mean(speechRate)) %>% 
  slice(1:50)


write_csv(d_grouped_50, "pitchScores.csv")

```


```{r}
setwd("/Users/bertram/Desktop/folders/Uni/4th/SocCult-Exam/ABM/Social-Cultural-Dynamics")

d <- read_csv("data.csv")

d$Diagnosis <- as.numeric(d$AgentID)
d$Diagnosis <- ifelse(d$Diagnosis < 29, "ASD", "TD")

# modeling conversation_time as predicted by diagnosis
model_conv <- lm(conversation_time ~ Diagnosis, data = d)
summary(model_conv)

# modeling n interactions as predicted by diagnosis
model_interactions <- lm(interactions ~ Diagnosis, data = d)
summary(model_interactions)

model_steps <- lm(conversation_time ~ 1 + Diagnosis + Diagnosis:Step, data = d)
summary(model_steps)
```




